<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>Amazon Recommender</title>

  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description"
    content="This is meta description.">
  
  <meta name="author" content="template creator : somrat, content creator: Jameson">
  <meta name="generator" content="Hugo 0.58.3" />

  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  
  <link rel="stylesheet" href="https://jamesonthai.github.io/plugins/bootstrap/bootstrap.min.css">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,700,900&amp;display=swap">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
  
  <link rel="stylesheet" href="https://jamesonthai.github.io/plugins/hover/hover.css">
  
  <link rel="stylesheet" href="https://jamesonthai.github.io/plugins/magnific-popup/magnific-popup.css">
  
  <link rel="stylesheet" href="https://jamesonthai.github.io/plugins/owl-carousel/owl.carousel.min.css">
  
  <link rel="stylesheet" href="https://jamesonthai.github.io/plugins/owl-carousel/owl.theme.default.min.css">
  
  <link rel="stylesheet" href="https://jamesonthai.github.io/plugins/text-animation/text-animation.css">
  

  
  
  <link rel="stylesheet" href="https://jamesonthai.github.io/css/style.min.css" media="screen">

  
  
  <link rel="stylesheet" href="https://jamesonthai.github.io/css/custom.min.css" media="screen">

  
  <link rel="shortcut icon" href="https://jamesonthai.github.io/images/favicon.png" type="image/x-icon">
  <link rel="icon" href="https://jamesonthai.github.io/images/favicon.png" type="image/x-icon">

  
  

  
  <meta property="og:image" content="https://jamesonthai.github.io/images/portfolio/amazon/Pipeline.png" />
  
  <meta property="og:title" content="Amazon Recommender" />
<meta property="og:description" content="This is meta description." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jamesonthai.github.io/portfolio/amazon_ratings/" />
<meta property="article:published_time" content="2018-11-12T12:14:34+06:00" />
<meta property="article:modified_time" content="2018-11-12T12:14:34+06:00" />

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-149141006-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


</head><body>
<!-- preloader start -->
<div class="preloader">
  
  <img src="https://jamesonthai.github.io/images/preloader.gif" alt="preloader">
  
</div>
<!-- preloader end -->

<section class="menu menu-fix" id="home">
  <nav>
    
    <div class="menu-container menu-normal">
      <ul class="desktop-menu list-inline mb-0 justify-content-end" id="desktop-menu">
        <a class="mr-auto" href="/">
          
          <img class="img-fluid" width="150px" src="https://jamesonthai.github.io/images/PI-dark.png"
            alt="Jameson&#39;s Portfolio">
          
        </a>
        
        <li class="menu-item menu-item-transparent dark hvr-underline-from-left 1"><a href="https://jamesonthai.github.io/">Home</a></li>
        
        <li class="menu-item menu-item-transparent dark hvr-underline-from-left 1"><a href="https://jamesonthai.github.io#about">About Me</a></li>
        
        <li class="menu-item menu-item-transparent dark hvr-underline-from-left 1"><a href="https://jamesonthai.github.io#service">Tech Stack</a></li>
        
        <li class="menu-item menu-item-transparent dark hvr-underline-from-left 1"><a href="https://jamesonthai.github.io#research">Tech Knowledge</a></li>
        
        <li class="menu-item menu-item-transparent dark hvr-underline-from-left 1"><a href="https://jamesonthai.github.io#portfolio">Portfolio</a></li>
        
        <li class="menu-item menu-item-transparent dark hvr-underline-from-left 1"><a href="https://jamesonthai.github.io/blog">Blog</a></li>
        
      </ul>
      
      

      
      <div class="mobile-menu">
        <a class="menu-link">
          <div class="mobile-menu-nav">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </a>
        <div class="mobile-menu-logo"><a href="/"><img class="img-fluid"
              src="https://jamesonthai.github.io/images/PI-dark.png" alt="Jameson&#39;s Portfolio"></a>
        </div>
        <div class="menu-slider">
          <nav>
            <ul class="mobile-menu-list">
              
              <li class="hvr-shutter-out-vertical mobile-menu-item 1"><a href="https://jamesonthai.github.io/">Home</a></li>
              
              <li class="hvr-shutter-out-vertical mobile-menu-item 1"><a href="https://jamesonthai.github.io#about">About Me</a></li>
              
              <li class="hvr-shutter-out-vertical mobile-menu-item 1"><a href="https://jamesonthai.github.io#service">Tech Stack</a></li>
              
              <li class="hvr-shutter-out-vertical mobile-menu-item 1"><a href="https://jamesonthai.github.io#research">Tech Knowledge</a></li>
              
              <li class="hvr-shutter-out-vertical mobile-menu-item 1"><a href="https://jamesonthai.github.io#portfolio">Portfolio</a></li>
              
              <li class="hvr-shutter-out-vertical mobile-menu-item 1"><a href="https://jamesonthai.github.io/blog">Blog</a></li>
              
            </ul>
            
            <ul class="mobile-menu-icons list-inline">
              
              <li><a href="https://github.com/JamesonThai"><i class="fab fa-github"></i></a></li>
              
              <li><a href="https://www.linkedin.com/in/jamesonthai/"><i class="fab fa-linkedin"></i></a></li>
              
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </nav>
</section>

<div style="height: 50px;"></div>


<style></style>
<section class="section " >
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mb-4 mb-lg-0">
        <div class="wow fadeInUp" data-wow-duration="1.5s">
          <img src="https://jamesonthai.github.io/images/portfolio/amazon/Pipeline.png" alt="image" class="img-fluid w-100 mb-5" width = "700", height = "450">
          <div class="about-me-text mb-4">
            <h1>Amazon Recommender</h1>
          </div>
          <div class="content">

<h1 id="table-of-contents">Table of Contents</h1>

<ol>
<li><a href="#Intro">Introduction</a></li>
<li><a href="#Goals">Goals</a></li>
<li><a href="#Algos">Algorithms</a></li>
<li><a href="#Data">Dataset</a></li>
<li><a href="#Mod">Models</a></li>
<li><a href="#Dp">Data Processing</a></li>
<li><a href="#Eval">Evaluation</a></li>
<li><a href="#Fin">Conclusion</a></li>
</ol>

<h1 id="Intro">Introduction</h1>

<p>Our project is an analysis of product and service reviews to determine the general overall sentiment expressed by it. Often, a review’s tone may be vague to a reader hoping to understand the reviews of the product. With our model’s analysis, we can supplement a user’s reading in better understanding the overall rating of the review. Amazon’s dataset provides an abundance of reviews and ratings that we can use to train our model. Additionally, our model can use rating values from 1 to 5 to classify a review’s tone as negative, somewhat negative, neutral, somewhat positive, and positive. Regarding an interface for interaction, we plan to construct a simple website to predict the likelihood of a block of test that it has a positive, or negative connotation. We narrated and presented our findings in the Amazon project to a group of our peers in that we found common singular words and n-grams used when describing a project. At the end of the project, we were able to build a prediction model where given a sentence it recommended a star rating from 1 being the worst to 5 being the best for the given sentence.</p>

<h1 id="Goals">Goals</h1>

<ul class="task-list">
<li><label><input type="checkbox" checked disabled class="task-list-item"> Acquire Amazon Dataset</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Exploratory analysis of dataset</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Use ML Algorithms to predict review ratings</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Build Jupyter notebook to predict ratings</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Visualize preprocessed information and compiled Bag Of Words</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Present findings to general and informed audience</label></li>
</ul>

<h1 id="Algos">Algorithms</h1>

<h3 id="naive-bayes">Naive Bayes</h3>

<p>Naive Bayes is an algorithm that assumes conditional independence from other variables. We use this as a multi classifier to determine what kind of rating a review would get. Additionally it is fairly easier to implement and outperforms other solutions in complex solutions. Since we are trying to rate from a range of 1 to 5, it is easier to modify a standard binary naive bayes classifier into a multi one. Moreover, the weights and labels we use in respect are easier to identify and implement with a bag of words.</p>

<h3 id="doc2vec">Doc2Vec</h3>

<p>Doc2Vec is an algorithm that builds on top of Word2Vec to vectorize documents. While Word2Vec only generates vectors for specific words, it does not capture the entire context of a sentence, paragraph, or document. Doc2Vec better matches our use case since each review as a whole corresponds to one context&ndash;the rating. Doc2Vec maintains not only the importance of word ordering, but also the labels associated with the documents which is where Word2Vec lacks. An alternative to Doc2Vec is a simple bag of words, but this approach loses all significance behind word ordering.</p>

<h3 id="logistic-regression-with-doc2vec">Logistic Regression with Doc2Vec</h3>

<p>Since Doc2Vec generates vectors from each document, each document can be seen as a point in a n-dimensional space (400-dimensional in our project). Logistic regression generates planes in our vector space that separates each of our categorical variables&ndash;ratings of 1, 2, 3, 4, and 5. While each cluster will not necessarily be separated perfectly, the notion that Doc2Vec can plot similar sounding documents in roughly similar areas, logistic regression should have at least an interesting performance.</p>

<h3 id="svm-with-doc2vec">SVM with Doc2Vec</h3>

<p>SVM will separate each cluster using linear planes with or without a transformation of our vector space. Since it is relatively unknown how the distribution of each vector will be classified, SVM would provide additional interesting results. The general notion is that SVM tends to work well on text classification.</p>

<h3 id="knn-with-doc2vec">KNN with Doc2Vec</h3>

<p>If the vectors produced by Doc2Vec places similarly rated reviews close to one another, KNN should provide relatively decent accuracy. However, reviews in vectorized form may not necessarily follow this clustering considering the wide variety of diction used especially in online reviews.</p>

<h1 id="Data">Dataset</h1>

<p>Our dataset was a compilation of Amazon reviews for electronics, books, movies, and television shows. These were the largest files which contained the most amount of reviews and totaled to 12 gigabytes worth of reviews. Each file was in JSON format which is easily parsed into Python as dictionary objects. After compiling all of the reviews into a single file, we had 536,777 one-star reviews, 599,659 two-star reviews, 1,298,748 three-star reviews, 2,953,129 four-star reviews, and 6,896,449 five-star reviews. This totaled to 12,284,762 reviews.
There were also some major problems with our data being internet jargon, punctuation, poor engligh and sarcasm.</p>

<p>Note: The main reason we used such a small dataset was because we did not have enough computing power. Just running Naive Bayes alone took around a 4 days of non-stop running on the local machine.</p>

<h1 id="Mod">Models</h1>

<p>We chose our set of models for specific reasons. Naive Bayes and SVMs have been known to be good with strong text classification, Doc2Vec turns blocks of text into vectors of numbers, Logistic Regression is generally good at classification problems, and KNN can anlyze the sentiment of nearby vectorized reviews that could be similar and possibly yield good results.</p>

<h1 id="Dp">Data Processing</h1>

<p><img src="https://raw.githubusercontent.com/JamesonThai/project_imgs_repo/master/amazon/Pipeline.png" alt="image" class="img-fluid w-100 mb-5"></p>

<p>Data preparation was split into multiple parts in order to convert reviews into usable vectors. Since we only needed the ratings and review text of each review, we were able to reduce the size of the data by removing all other fields. Once we had the review text, we had to parse it such that word casing was ignored and that all punctuation was stripped. Punctuation does not contribute a lot to the sentiment overall, so it was not needed. Since we are using online reviews, many of them do not have proper English used and contain a lot of internet jargon. We decided to keep this since internet jargon contributes to the sentiment of the text greatly and outlying words would not necessarily affect our models too much. Since there were unequal amounts of reviews and over 12 million of them, we decided to use a subset of our reviews where we have 75,000 reviews for each rating. This totaled to 375,000 reviews used in total. Using all 12 million reviews would have taken too long and brought too great of a toll onto our laptops.</p>

<p>The “data cleaner” removed all punctuation from each review, and lower cased every single word. The “data cleaner” then split the reviews into five separate files where each file contained reviews of one specific rating.</p>

<p>The Doc2Vec model then took these files and trained itself in twenty epochs to reinforce its neural networks on slightly lower learning rates in each epoch. The result of this was each review converted into a vector of length 400 where 66% of the reviews were kept for training and 33% of the reviews were kept for testing. For other models, we had to apply Doc2Vec to turn our text blocks into numerical vectors. We decided to make each vector of length 400 and train our Doc2Vec model 20 times with lower training rates in each iteration. This allowed us to feed the numerical vectors into multiple machine learning models in a format that was acceptable.</p>

<p>In the Naive Bayes approach (bottom), we used the same five separate files and conducted data preprocessing. We removed stop words, common words and rare words that were present in each of the rating datasets and aggregated them. We then split that information into a Training and Test Set while also creating a Bag of Words. The Bag of Words was constructed by analyzing and compiling the most frequent words present in each rating dataset. We also needed to tokenize our reviews so that determine the word frequency distribution in that set. From there we removed stopwords (I, As, Am, His, A, And, etc..) since they do not contribute to the overall sentiment. Along with stopwords, we also removed a small number of common words and rare words that only appeared once. This allowed us to see the frequency of each word in both the individual rating category and the overall rating category. Both the Training and Test Set were used in conjunction with the Bag Of Words to train the classifier or determine the accuracy of the model. The training test split is 80-20.</p>

<h1 id="Eval">Evaluation</h1>

<p>To train and test our data, we decided to use a hold out set. For our Doc2Vec models, we used 50,000 reviews from each rating for training and 25,000 review from each rating for testing. For Naive Bayes, we used 10,000 reviews from each rating for training and 2,500 reviews from each rating for testing. We had more than enough data to use, and ended up using only about 3% of what we had originally, so a hold out set was perfectly applicable.</p>

<p><img src="https://raw.githubusercontent.com/JamesonThai/project_imgs_repo/master/amazon/model_res.png" alt="image" class="img-fluid w-100 mb-5"></p>

<p>In the image above, these evaluations are based on their accuracy. Going from best to worst is from right to left. From these we decided to continue with the Logistic Regression and linear SVM models since they gave more promising results as seen in the image below.</p>

<p><img src="https://raw.githubusercontent.com/JamesonThai/project_imgs_repo/master/amazon/svmvslog.png" alt="image" class="img-fluid w-100 mb-5"></p>

<p>RBF SVM, Naive Bayes, and K Nearest Neighbors use similar datasets since they take much longer to train and test.</p>

<p><img src="https://raw.githubusercontent.com/JamesonThai/project_imgs_repo/master/amazon/log_output.png" alt="image" class="img-fluid w-100 mb-5"></p>

<p>As seen from the previous image, reducing the scope of the predictions result in significantly better accuracies. Classifying only very positive (5) and very negative (1) yields about 89% accuracy. Classifying very positive (5), neutral (3), and very bad (1) yields about 73% accuracy.</p>

<h1 id="Fin">Conclusion</h1>

<p>The Doc2Vec, Linear SVM, and Logistic Regression model worked well whereas the Naive Bayes and KNN models did not. Non-Linear SVM took too long to train (4+ days&hellip;). Some other problems were that the training duration would last for hours at time, thus every samll change in our code had to be retrained. Tokenization was also a debateable topic considering the value of punctuation in English and how to capture their importance. Additionally, more sophisticated tokenization algorithms took far longer. Cleaning the input data to fit the structure was also required for the Doc2Vec since it required a specific object type to be passed into it, that and Doc2Vec is not that well documented or intuitived to use. Looking back, if we had a better understanding of the algorithms, we could have hyper-parameter tuned that resulted in a better performance. Additionally having a larger dataset to use and more computationaly available hardware would of led to quicker and better results.</p>
</div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="bg-white sticky-top wow fadeInUp" data-wow-duration="1.5s" style="top: 80px;">
          <ul class="list-unstyled">
            <li class="media mb-4">
              <i class="mt-1 fas fa-calendar h2"></i>
               <div class="ml-3">
                 <h4>Date</h4>
                 <div class="content">12 Nov, 2018</div>
               </div>
             </li>
             <li class="media mb-4">
               <i class="mt-1 fas fa-folder h2"></i>
                <div class="ml-3">
                  <h4>Categories</h4>
                  <div class="content"> Natural Language Processing, Machine Learning, Data Science</div>
                </div>
              </li>
            
            <li class="media mb-4">
             <i class="mt-1 fas fa-link h2"></i>
              <div class="ml-3">
                <h4>Main Github Link</h4>
                <div class="content"><a href="https://github.com/JamesonThai/Amazon-Review-Sentiment-Analysis">https://github.com/JamesonThai/Amazon-Review-Sentiment-Analysis</a></div>
              </div>
            </li>
            
            <li class="media mb-4">
             <i class="mt-1 fas fa-code h2"></i>
              <div class="ml-3">
                <h4>Technologies Stack</h4>
                <div class="content">Python, Natural Language Processing, Naive Bayes, Doc2Vec, Bag of Words, Logistic Regression, Linear SVM, Pandas, Random Forests, Amazon Dataset, Data Analysis, Scikit-Learn, Recommendation Systems, JSON, Jupyter Notebook, Sentiment Analysis, Conda</div>
              </div>
            </li>
            
            <li class="media mb-4">
             <i class="mt-1 fas fa-question-circle h2"></i>
              <div class="ml-3">
                <h4>Status</h4>
                <div class="content">Finished: April 2018-December 2018</div>
              </div>
            </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>


	<footer class="footer-bg fadeInUp wow" data-wow-duration="1.5s">
  <div class="container">
    <div class="row">
      <div class="footer col-lg-10 offset-lg-1">
        <hr>
        <ul class="footer-icons list-inline">
          
          <li><a href="https://github.com/JamesonThai"><i class="fab fa-github"></i></a></li>
          
          <li><a href="https://www.linkedin.com/in/jamesonthai/"><i class="fab fa-linkedin"></i></a></li>
          
        </ul>
        <div class="to-top">
          <a href="#home"><i class="fa fa-chevron-up"></i></a>
        </div>
        <div class="credit content">
          Copyright &copy; 2020 a hugo theme by <a href="https://somrat.netlify.com">somrat</a>
        </div>
      </div>
    </div>
  </div>
</footer><!-- JS Plugins -->

<script src="https://jamesonthai.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://jamesonthai.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://jamesonthai.github.io/plugins/wow.min.js"></script>

<script src="https://jamesonthai.github.io/plugins/text-animation/text-animation.js"></script>

<script src="https://jamesonthai.github.io/plugins/jquery.waypoints.min.js"></script>

<script src="https://jamesonthai.github.io/plugins/shuffle/shuffle.min.js"></script>

<script src="https://jamesonthai.github.io/plugins/magnific-popup/jquery.magnific-popup.min.js"></script>

<script src="https://jamesonthai.github.io/plugins/owl-carousel/owl.carousel.min.js"></script>


<!-- Main Script -->

<script src="https://jamesonthai.github.io/js/script.min.js"></script>

<!-- google analitycs -->
</body>

</html>